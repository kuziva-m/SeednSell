System.register([],function(e,t){"use strict";return{execute:function(){var n=document.createElement("style");n.textContent=":root{--primary-color: #467e23;--primary-color-hover: #38661d;--secondary-color: #e8f5e9;--danger-color: #d9534f;--danger-color-hover: #c9302c;--font-family: \"Poppins\", sans-serif;--border-radius-md: 8px;--border-radius-sm: 4px;--max-width: 1200px;--text-main: #333;--text-muted: #555;--text-light: #777;--bg-main: #f4f4f4;--bg-white: #fff;--border-color: #ddd;--box-shadow: 0 4px 12px rgba(0, 0, 0, .05);--box-shadow-hover: 0 8px 16px rgba(0, 0, 0, .1)}body{background-image:url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 30c0-5.523 4.477-10 10-10s10 4.477 10 10-4.477 10-10 10-10-4.477-10-10zM0 30c0-5.523 4.477-10 10-10s10 4.477 10 10-4.477 10-10 10-10-4.477-10-10z' fill='%23689f38' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E\")}body.theme-inputs{--primary-color: #546e7a;--primary-color-hover: #455a64;--secondary-color: #eceff1;background-image:url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 30c0-5.523 4.477-10 10-10s10 4.477 10 10-4.477 10-10 10-10-4.477-10-10zM0 30c0-5.523 4.477-10 10-10s10 4.477 10 10-4.477 10-10 10-10-4.477-10-10z' fill='%23546e7a' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E\")}body.theme-services{--primary-color: #0288d1;--primary-color-hover: #0277bd;--secondary-color: #e1f5fe;background-image:url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M30 30c0-5.523 4.477-10 10-10s10 4.477 10 10-4.477 10-10 10-10-4.477-10-10zM0 30c0-5.523 4.477-10 10-10s10 4.477 10 10-4.477 10-10 10-10-4.477-10-10z' fill='%230288d1' fill-opacity='0.05' fill-rule='evenodd'/%3E%3C/svg%3E\")}\n/*$vite$:1*/",document.head.appendChild(n),e({b:h,c:g});const i=function(e,t,n){let i=Promise.resolve();function o(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return i.then(t=>{for(const e of t||[])"rejected"===e.status&&o(e.reason);return e().catch(o)})},o=e("C",{SUPABASE:{URL:"https://jupbwnbhxirfvsmrqiko.supabase.co",ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp1cGJ3bmJoeGlyZnZzbXJxaWtvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIxMjQ2OTksImV4cCI6MjA3NzcwMDY5OX0.ZIskD5R-E-hJVmUGTV8O3kGW70_iXoWtlFU3M_Xr5Gc"},COMPANY_USER_ID:"fb874327-31b0-4857-81e2-75f292bc21f6",IMAGES:{BUCKET:"product_images",MAX_SIZE_BYTES:5242880,ALLOWED_TYPES:["image/jpeg","image/png"]}}),{createClient:a}=supabase,s=e("s",a(o.SUPABASE.URL,o.SUPABASE.ANON_KEY));let r=null,l=null,c=null,d=null;function u(){s.auth.onAuthStateChange((e,t)=>{if(console.log("Auth event:",e),t){l=t.user.id,document.dispatchEvent(new CustomEvent("auth:resolved",{detail:{userId:l}}));const e=document.getElementById("header-auth-section");if(e){e.innerHTML='\n          <div style="display: flex; align-items: center; gap: 15px;">\n            <a href="/dashboard.html" class="user-avatar-btn" title="Go to Dashboard">\n              <div class="avatar-circle">\n                <i class="fa-solid fa-user"></i>\n              </div>\n              <span class="user-name-text" id="header-username">My Account</span>\n            </a>\n            <button id="header-logout-btn" class="action-icon" style="background: none; border: none; cursor: pointer; font-size: 1.2rem; padding: 5px;" title="Log Out">\n              <i class="fa-solid fa-right-from-bracket" style="color: var(--danger-color);"></i>\n            </button>\n          </div>\n        ';const t=document.getElementById("header-logout-btn");t&&t.addEventListener("click",()=>{const e=document.getElementById("logout-modal");e&&e.classList.add("is-visible")})}window.location.pathname.includes("auth.html")&&(window.location.href="/index.html"),async function(e){const{data:t,error:n}=await s.from("profiles").select("*").eq("id",e).single();if(!n)return t}(l).then(e=>{r=e}),g(),h()}else{r=null,l=null,window.location.pathname.includes("dashboard.html")&&(window.location.href="/auth.html");const e=document.getElementById("header-auth-section");e&&(e.innerHTML='<a href="/auth.html" class="login-link">Login</a>'),c&&c.unsubscribe()}})}function m(){const e=document.getElementById("signup-form"),t=document.getElementById("login-form"),n=document.getElementById("signup-password"),i=document.getElementById("signup-phone");i&&window.intlTelInput&&(d=window.intlTelInput(i,{initialCountry:"zw",preferredCountries:["zw","za","zm","mz"],separateDialCode:!0,utilsScript:"https://cdn.jsdelivr.net/npm/intl-tel-input@18.2.1/build/js/utils.js"})),n&&n.addEventListener("input",t=>{const n=t.target.value,i=e?e.querySelector("button"):null;n.length>0&&n.length<6?(t.target.style.borderColor="var(--danger-color)",f("Password is too short (min 6 chars)","error"),i&&(i.disabled=!0)):(t.target.style.borderColor="#ccc",f("",""),i&&(i.disabled=!1))}),e&&e.addEventListener("submit",async t=>{t.preventDefault();const n=e.querySelector("button[type='submit']");if(d){if(!d.isValidNumber())return f("Please enter a valid phone number.","error"),void(i.style.borderColor="var(--danger-color)");const e=d.getNumber();i.value=e}const o=document.getElementById("signup-email");if(!function(e){return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(String(e).toLowerCase())}(o.value))return f("Please enter a valid email address.","error"),void(o.style.borderColor="var(--danger-color)");n.disabled=!0,n.innerHTML='<span class="spinner"></span>Creating Account...';const a=o.value,r=document.getElementById("signup-password").value,l=document.getElementById("signup-name").value,c=i.value,u=document.getElementById("signup-city").value,m=document.getElementById("signup-area").value;document.getElementById("signup-entity-type").value;const g=document.getElementById("signup-role").value,h=`${u}, ${m}`,{data:p,error:v}=await s.auth.signUp({email:a,password:r});if(v)return f(v.message,"error"),n.disabled=!1,void(n.innerHTML="Sign Up");if(p.user){const{error:e}=await s.from("profiles").insert({id:p.user.id,full_name:l,phone_number:c,location:h,user_role:g});e?(console.error("Profile save error:",e),f("Sign up successful, but profile saving failed.","error"),n.disabled=!1,n.innerHTML="Sign Up"):(f("Sign up successful! Redirecting...","success"),window.location.href="/index.html")}}),t&&t.addEventListener("submit",async e=>{e.preventDefault();const n=t.querySelector("button[type='submit']");n.disabled=!0,n.innerHTML='<span class="spinner"></span>Logging In...';const i=document.getElementById("login-email").value,o=document.getElementById("login-password").value,{error:a}=await s.auth.signInWithPassword({email:i,password:o});a?(f(a.message,"error"),n.disabled=!1,n.innerHTML="Log In"):(f("Login successful! Redirecting...","success"),window.location.href="/index.html")})}async function g(){const e=await s.auth.getUser();if(!e.data.user)return;const{data:t}=await s.rpc("get_room_unread_counts",{p_user_id:e.data.user.id});if(t&&t.length>0){const e=document.getElementById("notification-bubble"),t=document.getElementById("bottom-nav-bubble");e&&e.classList.add("active"),t&&t.classList.add("active")}}function h(){const e=p();e&&!c&&(c=s.channel("public:chat_messages").on("postgres_changes",{event:"INSERT",schema:"public",table:"chat_messages",filter:`receiver_id=eq.${e}`},()=>{const e=document.getElementById("notification-bubble"),t=document.getElementById("bottom-nav-bubble");e&&e.classList.add("active"),t&&t.classList.add("active")}).subscribe())}function f(e,t){const n=document.getElementById("auth-message");n&&(n.textContent=e,n.className=t)}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("logout-modal"),t=document.getElementById("logout-cancel-btn"),n=document.getElementById("logout-confirm-btn");e&&t&&n&&(t.addEventListener("click",()=>e.classList.remove("is-visible")),e.addEventListener("click",t=>{t.target===e&&e.classList.remove("is-visible")}),n.addEventListener("click",async()=>{await s.auth.signOut(),window.location.href="/index.html"}))});const p=e("a",()=>l),v=e("g",()=>r);function b(){const e=document.getElementById("mobile-menu-btn");e&&e.setAttribute("aria-expanded","false")}if(async function(){!function(){const e="G-WCRTQLKDC6";if(document.getElementById("ga-script"))return;const t=document.createElement("script");function n(){window.dataLayer.push(arguments)}t.id="ga-script",t.async=!0,t.src=`https://www.googletagmanager.com/gtag/js?id=${e}`,document.head.appendChild(t),window.dataLayer=window.dataLayer||[],window.gtag=n,n("js",new Date),n("config",e),console.log(`Analytics initialized: ${e}`)}(),await async function(){const e=document.getElementById("global-header"),t=document.getElementById("global-footer"),n=document.getElementById("global-mobile-nav"),i=[];e&&i.push(fetch("/components/header.html").then(e=>e.text()).then(t=>{e.innerHTML=t;const n=new URLSearchParams(window.location.search).get("cat")||"produce",i=e.querySelector(`.nav-pill[href*="cat=${n}"]`);i&&i.classList.add("active")})),t&&i.push(fetch("/components/footer.html").then(e=>e.text()).then(e=>{t.innerHTML=e})),n&&i.push(fetch("/components/mobile-nav.html").then(e=>e.text()).then(e=>{n.innerHTML=e;const t=window.location.pathname,i=n.querySelector(`.nav-item[href="${t}"]`);i&&i.classList.add("active")})),await Promise.all(i)}(),u(),function(){const e=document.querySelectorAll(".fade-in-section");if(0===e.length)return;const t=new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("is-visible"),t.unobserve(e.target))})},{root:null,rootMargin:"0px",threshold:.1});e.forEach(e=>{t.observe(e)})}(),function(){const e=document.querySelector(".mobile-nav-toggle"),t=document.getElementById("primary-navigation");if(!e||!t)return;e.addEventListener("click",()=>{const n=t.classList.contains("is-open");e.setAttribute("aria-expanded",!n),t.classList.toggle("is-open"),document.body.classList.toggle("nav-open")});const n=t.querySelectorAll("a");n.forEach(n=>{n.addEventListener("click",()=>{t.classList.contains("is-open")&&(e.setAttribute("aria-expanded",!1),t.classList.remove("is-open"),document.body.classList.remove("nav-open"))})});const i=t.querySelector(".magic-line"),o=t.querySelector("a.active");function a(e){e?(i.style.left=`${e.offsetLeft}px`,i.style.width=`${e.offsetWidth}px`):i.style.width="0px"}i&&n.length&&(a(o),n.forEach(e=>{e.addEventListener("mouseover",()=>a(e))}),t.addEventListener("mouseleave",()=>a(o)))}(),function(){const e=document.querySelector("header");e&&window.addEventListener("scroll",()=>{window.scrollY>10?e.classList.add("is-scrolled"):e.classList.remove("is-scrolled")})}(),async function(){const e=window.location.pathname;try{if(e.endsWith("/")||e.endsWith("/index.html")){const{initListingsPage:e}=await i(async()=>{const{initListingsPage:e}=await t.import("./listings-legacy-B5we2P88.js");return{initListingsPage:e}}),{initToggleSlider:n}=await i(async()=>{const{initToggleSlider:e}=await t.import("./toggle-legacy-dvCgEYpj.js");return{initToggleSlider:e}});e(),n()}else if(e.endsWith("/listing.html")){const{initListingDetailPage:e}=await i(async()=>{const{initListingDetailPage:e}=await t.import("./listings-legacy-B5we2P88.js");return{initListingDetailPage:e}});e()}else if(e.endsWith("/dashboard.html")){const{initDashboardPage:e}=await i(async()=>{const{initDashboardPage:e}=await t.import("./dashboard-legacy-TsNrm1Jy.js");return{initDashboardPage:e}});e()}else if(e.endsWith("/messages.html")){const{initChatPage:e}=await i(async()=>{const{initChatPage:e}=await t.import("./chat-legacy-qfHA6jx8.js");return{initChatPage:e}});e()}else e.endsWith("/auth.html")&&m()}catch(n){console.error("Page logic error:",n)}}()}(),document.addEventListener("click",e=>{const t=e.target.closest("#mobile-menu-btn"),n=e.target.closest("#close-menu-btn"),i=document.getElementById("mobile-menu-overlay");t&&i&&(t.setAttribute("aria-expanded","true"),function(){const e=p(),t=v(),n=document.getElementById("menu-user-name"),i=document.getElementById("menu-auth-link");if(e){if(n.textContent=`Hi, ${t?.full_name||"Farmer"}`,i&&(i.href="/dashboard.html",i.innerHTML='<i class="fa-solid fa-user"></i> My Dashboard'),!document.getElementById("menu-logout")){const e=document.querySelector(".mobile-menu-links");if(e){const t=document.createElement("a");t.id="menu-logout",t.href="#",t.className="menu-link",t.style.color="var(--danger-color)",t.innerHTML='<i class="fa-solid fa-right-from-bracket"></i> Log Out',t.onclick=e=>{e.preventDefault();const t=document.getElementById("logout-modal");t&&t.classList.add("is-visible"),document.getElementById("mobile-menu-overlay").classList.remove("is-visible")},e.appendChild(t)}}}else{n.textContent="Welcome, Guest",i&&(i.href="/auth.html",i.innerHTML='<i class="fa-solid fa-right-to-bracket"></i> Login / Sign Up');const e=document.getElementById("menu-logout");e&&e.remove()}}(),i.classList.add("is-visible")),n&&i&&(i.classList.remove("is-visible"),b()),e.target===i&&(i.classList.remove("is-visible"),b()),e.target.closest(".protected-link")&&(p()||(e.preventDefault(),window.location.href="/auth.html"))}),"serviceWorker"in navigator){let e=!1;navigator.serviceWorker.addEventListener("controllerchange",()=>{e||(e=!0,window.location.reload())})}window.showToast=function(e,t="info"){let n=document.getElementById("toast-container");n||(n=document.createElement("div"),n.id="toast-container",document.body.appendChild(n));const i=document.createElement("div");i.className=`toast ${t}`;let o="success"===t?"fa-circle-check":"error"===t?"fa-triangle-exclamation":"fa-circle-info";i.innerHTML=`<i class="fa-solid ${o}"></i> <span>${e}</span>`,n.appendChild(i),setTimeout(()=>{i.style.animation="fadeOutToast 0.3s forwards",i.addEventListener("animationend",()=>i.remove())},4e3)}}}});
